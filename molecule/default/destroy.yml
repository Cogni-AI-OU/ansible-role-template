---
- name: Destroy
  hosts: localhost
  connection: local
  gather_facts: false
  vars:
    # Use system Python with requests installed for Docker modules on the controller.
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
  tasks:
    - name: Stop and remove test containers
      community.docker.docker_container:
        name: "{{ item.name }}"
        state: absent
        force_kill: true
      loop: "{{ molecule_yml.platforms }}"

    - name: Reset instance config
      ansible.builtin.copy:
        content: |
          # Molecule managed

          []
        dest: "{{ molecule_instance_config }}"
        mode: "0600"
